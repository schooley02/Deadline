<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8"> <!-- ... --> <title>Deadline - MPE</title> <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="app-container">
        <div class="header-info">
            <h1>Deadline MPE</h1>
            <div class="player-stats">
                <span>Base Health: <span id="baseHealthDisplay">100</span></span>
                <span>XP: <span id="playerXpDisplay">0</span></span>
                <span>Level: <span id="playerLevelDisplay">1</span></span>
                <span>Routine Slots: <span id="routineSlotsDisplay">1</span></span>
            </div>
            <div id="levelUpMessage" class="hidden">LEVEL UP!</div>
            <div id="gameOverMessage" class="hidden">GAME OVER! Your Base Survived 0 Days.</div>
        </div>

        <div id="gameScreen"> <div id="base">CHURCH</div> </div>

        <div id="taskListContainer"> <!-- Will now be for active items from tasks/active routines -->
            <h2>Today's Deadlines</h2>
            <ul id="activeItemsList"> </ul>
        </div>

        <div class="input-controls-container">
        <div style="margin-top: 20px; border-bottom: 1px solid #777; padding-top:10px; padding-bottom:40px;">
            <h4>Debug Controls</h4>
            <button id="debugAdvanceDayButton">Simulate Next Day</button>
            <button id="debugResetHabitStreaksButton">Reset All Habit Streaks</button>
            <button id="debugDamageBaseButton">Damage Base (-10 HP)</button> <!-- New Button -->
        </div>
        <button id="restartButton" class="hidden">Start New Base (Restart)</button>


            <div class="form-toggle-buttons">
                <button id="showTaskFormButton" class="active">Add Task</button>
                <button id="showHabitFormButton">Add Habit</button>
                <button id="showRoutineFormButton">Manage Routines</button>
            </div>

            <div id="taskForm" class="controls active-form">
                <h3>Add New Task</h3>
                <div>
                    <label for="taskName">Task Name:</label>
                    <input type="text" id="taskName" placeholder="Name of the task">
                </div>
                <div>
                    <label for="taskCategory">Category:</label>
                    <select id="taskCategory">
                        <option value="other">Other (Generic)</option>
                        <option value="career">Career</option>
                        <option value="creativity">Creativity</option>
                        <option value="financial">Financial</option>
                        <option value="health">Health</option>
                        <option value="lifestyle">Lifestyle</option>
                        <option value="relationships">Relationships</option>
                        <option value="spirituality">Spirituality</option>
                    </select>
                </div>
                <div class="priority-input">
                    <input type="checkbox" id="taskHighPriority">
                    <label for="taskHighPriority">High Priority</label>
                </div>
                <div>
                    <label for="dueDate">Due Date:</label>
                    <input type="date" id="dueDate">
                </div>
                <div>
                    <label for="dueTime">Due Time:</label>
                    <input type="time" id="dueTime">
                </div>
                <button id="addTaskButton">Add Task</button>
            </div>

            <div id="habitForm" class="controls">
                <h3>Add New Habit</h3>
                <div>
                    <label for="habitName">Habit Name:</label>
                    <input type="text" id="habitName" placeholder="e.g., Drink Water, Exercise">
                </div>
                <div>
                    <label for="habitCategory">Category:</label>
                    <select id="habitCategory">
                        <option value="other">Other (Generic)</option>
                        <option value="career">Career</option>
                        <option value="creativity">Creativity</option>
                        <option value="financial">Financial</option>
                        <option value="health">Health</option>
                        <option value="lifestyle">Lifestyle</option>
                        <option value="relationships">Relationships</option>
                        <option value="spirituality">Spirituality</option>
                    </select>
                </div>
                <div>
                    <label for="habitFrequency">Frequency:</label>
                    <select id="habitFrequency">
                        <option value="daily">Daily</option>
                    </select>
                </div>
                <div>
                    <label for="habitTimeOfDay">Completion Window:</label>
                    <select id="habitTimeOfDay">
                        <option value="anytime">Anytime Today</option>
                        <option value="morning">Morning (by 12 PM)</option>
                        <option value="afternoon">Afternoon (by 5 PM)</option>
                        <option value="evening">Evening (by 10 PM)</option>
                    </select>
                </div>
                <button id="addHabitButton">Add Habit</button>
            </div>

            <!-- Routine Management Form/View (Initially Hidden) -->
            <div id="routineForm" class="controls">
                <!-- ... Your routine form content is correct here ... -->
                <h3>Manage Routines</h3>
                <div class="routine-creation">
                    <label for="routineName">New Routine Name:</label>
                    <input type="text" id="routineName" placeholder="e.g., Morning Ritual">
                    <button id="createRoutineButton">Create Routine</button>
                </div>
                <div id="routineListContainer">
                    <h4>Your Routines: (<span id="activeRoutineCountDisplay">0</span>/<span id="totalRoutineSlotsDisplay">1</span> Active)</h4>
                    <ul id="definedRoutinesList">
                        <!-- JS populates this -->
                    </ul>
                </div>
            </div>
            <button id="restartButton" class="hidden">Start New Base (Restart)</button>
        </div>

        <!-- ... (Debug controls if you still have them) ... -->
    </div>
    <script src="script.js"></script>
</body>
</html>